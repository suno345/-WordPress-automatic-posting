# VPSシステム Git経由アップデートコマンド

## 1. VPSにSSH接続
ssh member1@your-vps-ip

## 2. プロジェクトディレクトリに移動
cd wordpress-auto-posting

## 3. 現在のブランチとステータス確認
git status
git branch
git log --oneline -3

## 4. 最新コードをプル（強制更新）
git fetch origin
git reset --hard origin/main

## 5. 仮想環境をアクティベート
source venv/bin/activate

## 6. 依存関係の更新（必要に応じて）
pip install -r requirements.txt

## 7. システム動作確認
python execute_scheduled_posts.py --vps-mode --status

## 8. 最新バージョン（v2.1.0）の修正内容確認
echo "=== 最新バージョン v2.1.0 の修正内容 ==="
echo "✅ WordPress投稿エラー修正：'int' object has no attribute 'get'"
echo "✅ WordPress API戻り値を辞書形式に統一"
echo "✅ JSONシリアライズエラー修正：'unhashable type: dict'"
echo "✅ プロジェクトディレクトリ整理・最適化"
echo "✅ 重複ファイル削除（setup_cron.sh, 作成仕様.md等）"
echo "✅ キャッシュファイル削除（__pycache__, .pyc等）"
echo "✅ VPS予約投稿システム100%動作確認済み"

## 9. cronジョブの動作確認
echo "=== Cronジョブ設定確認 ==="
crontab -l

## 10. テスト実行（1件）
echo "=== システムテスト実行 ==="
python execute_scheduled_posts.py --vps-mode --multiple 1

## 11. ログファイルの確認
echo "=== 最新ログ確認 ==="
ls -la logs/
tail -20 logs/scheduled_posts_$(date +%Y%m%d).log

## ワンライナー実行コマンド（安全更新）
# ssh member1@your-vps-ip "cd wordpress-auto-posting && git fetch origin && git reset --hard origin/main && source venv/bin/activate && python execute_scheduled_posts.py --vps-mode --status"

## 緊急時ロールバックコマンド
# git reset --hard 8a14040  # 前回の安定版に戻す